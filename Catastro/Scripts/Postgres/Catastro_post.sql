-- MySQL Script generated by MySQL Workbench
-- Thu Dec 20 02:14:55 2018
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

-- -----------------------------------------------------
-- Table `mydb`.`Zonas`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS Zonas (
  Nombre VARCHAR(45) NOT NULL,
  Calle VARCHAR(45) NULL,
  PRIMARY KEY (Nombre));


-- -----------------------------------------------------
-- Table `mydb`.`Unifamiliares`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS Unifamiliares (
  nombre VARCHAR(45) NOT NULL,
  DNI INT NOT NULL,
  nombre_zona VARCHAR(45) NULL,
  PRIMARY KEY (nombre, DNI),
  CONSTRAINT fk_nombrezona
    FOREIGN KEY (nombre_zona)
    REFERENCES Zonas (Nombre)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);

CREATE INDEX fk_nombrezona_idx ON Unifamiliares(nombre_zona ASC);


-- -----------------------------------------------------
-- Table `mydb`.`Piso`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS Piso (
  Numero VARCHAR(45) NOT NULL,
  DNI INT NOT NULL,
  Nombre_zona VARCHAR(45) NULL,
  Bloque VARCHAR(45) NULL,
  PRIMARY KEY (Numero, DNI),
  CONSTRAINT fk_nombrezona
    FOREIGN KEY (Nombre_zona)
    REFERENCES Zonas (Nombre)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
;

CREATE INDEX fk_nombrezona_id ON Piso (Nombre_zona ASC);
-- -----------------------------------------------------
-- Table `mydb`.`Familia`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS Familia (
  DNI INT NOT NULL,
  Nombre VARCHAR(45) NULL,
  numero_personas VARCHAR(45) NULL,
  nombre_v VARCHAR(45) NULL,
  PRIMARY KEY (DNI),
  CONSTRAINT fk_dnicabezapropi
    FOREIGN KEY (DNI,nombre_v)
    REFERENCES Unifamiliares (DNI,nombre)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT fk_dnicabezapiso
    FOREIGN KEY (DNI,nombre_v)
    REFERENCES Piso (DNI,Numero)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);


-- -----------------------------------------------------
-- Data for table `mydb`.`Zonas`
-- -----------------------------------------------------
INSERT INTO Zonas (Nombre, Calle) VALUES ('Zona1', 'CaminoVerde');
INSERT INTO Zonas (Nombre, Calle) VALUES ('Zona2', 'CaminoAmarillo');
INSERT INTO Zonas (Nombre, Calle) VALUES ('Zona3', 'CaminoAzul');


-- -----------------------------------------------------
-- Data for table `mydb`.`Unifamiliares`
-- -----------------------------------------------------
INSERT INTO Unifamiliares (nombre, DNI, nombre_zona) VALUES ('Vivienda1', 1111, 'Zona1');
INSERT INTO Unifamiliares (nombre, DNI, nombre_zona) VALUES ('Vivienda2', 2222, 'Zona1');
INSERT INTO Unifamiliares (nombre, DNI, nombre_zona) VALUES ('Vivienda3', 3333, 'Zona2');


-- -----------------------------------------------------
-- Data for table `mydb`.`Piso`
-- -----------------------------------------------------
INSERT INTO Piso (Numero, DNI, Nombre_zona, Bloque) VALUES ('3A', 4444, 'Zona2', '1A');
INSERT INTO Piso (Numero, DNI, Nombre_zona, Bloque) VALUES ('2B', 5555, 'Zona2', '2C');
INSERT INTO Piso (Numero, DNI, Nombre_zona, Bloque) VALUES ('5C', 6666, 'Zona3', '1A');


-- -----------------------------------------------------
-- Data for table `mydb`.`Familia`
-- -----------------------------------------------------
INSERT INTO Familia (DNI, Nombre, numero_personas) VALUES (1111, 'Juan', '4');
INSERT INTO Familia (DNI, Nombre, numero_personas) VALUES (2222, 'Julia', '2');
INSERT INTO Familia (DNI, Nombre, numero_personas) VALUES (3333, 'Manuel', '1');
INSERT INTO Familia (DNI, Nombre, numero_personas) VALUES (4444, 'Sara', '3');
INSERT INTO Familia (DNI, Nombre, numero_personas) VALUES (5555, 'Sofia', '5');
INSERT INTO Familia (DNI, Nombre, numero_personas) VALUES (6666, 'Lucia', '1');

